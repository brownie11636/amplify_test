(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6328],{43356:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/monkey-eye/operate",function(){return r(73365)}])},73365:function(e,n,r){"use strict";r.r(n),r.d(n,{App:function(){return w},default:function(){return S}});var s=r(47568),t=r(828),a=r(34051),o=r.n(a),c=r(85893),i=r(67294),l=r(86809),d=r.n(l),u=r(44108),m=r(73538),g=r(78348),h=(r(41664),r(5152)),f=r.n(h),v=f()((function(){return r.e(8043).then(r.bind(r,18043)).then((function(e){return e.Donut}))}),{loadableGenerated:{webpack:function(){return[18043]}},ssr:!1});function p(e){var n=(0,i.useState)(!1),r=(n[0],n[1]),s=(0,i.useState)(0),t=s[0],a=s[1];(0,i.useEffect)((function(){a(e.value),r(!0)}),[]);return(0,c.jsx)("div",{className:"single-knob",children:(0,c.jsx)(v,{diameter:150,min:0,max:100,step:1,value:t,theme:{donutColor:"white",bgrColor:"gray",maxedBgrColor:"red",centerColor:"#1c1945",centerFocusedColor:"#13112e",donutThickness:3},onValueChange:function(n){a(n),e.onChange(e.id,n)},ariaLabelledBy:"my-label",children:(0,c.jsx)("label",{id:"my-label",children:e.label})})})}var x=f()((function(){return r.e(8043).then(r.bind(r,18043)).then((function(e){return e.Donut}))}),{loadableGenerated:{webpack:function(){return[18043]}},ssr:!1});function j(e){var n=(0,i.useState)(!1),r=(n[0],n[1]),s=(0,i.useState)(0),t=s[0],a=s[1];return(0,i.useEffect)((function(){a(e.value),r(!0)}),[]),(0,c.jsx)("div",{className:"single-knob-indicator",children:(0,c.jsx)(x,{diameter:80,min:0,max:100,step:1,value:t,theme:{donutColor:"yellow",bgrColor:"gray",maxedBgrColor:"red",centerColor:"#1c1945",centerFocusedColor:"#13112e",donutThickness:3},ariaLabelledBy:"my-label",children:(0,c.jsx)("label",{id:"my-label",children:e.label})})})}var b=function(e){var n={arm:{0:50,1:90,2:90,3:0}},r=(0,i.useState)(n),s=r[0],t=r[1],a=function(r,a){(n=s).arm[r]=a,t(n),e.onChange(s)};return(0,c.jsxs)("section",{className:"services-area bg-f2f6f9 ptb-110",children:[(0,c.jsx)("div",{className:"control-area",children:(0,c.jsxs)("div",{className:"control-panel",children:[(0,c.jsx)("label",{className:"title",children:"Control Box"}),(0,c.jsx)("div",{className:"container",children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-lg-8",children:(0,c.jsxs)("div",{className:"controller",children:[(0,c.jsx)("label",{className:"title",children:"Control"}),(0,c.jsx)("div",{className:"knob-box",children:(0,c.jsx)(p,{onChange:a,id:0,value:s.arm[0],label:"height"})}),(0,c.jsx)("div",{className:"knob-box",children:(0,c.jsx)(p,{onChange:a,id:1,value:s.arm[1],label:"length"})}),(0,c.jsx)("div",{className:"knob-box",children:(0,c.jsx)(p,{onChange:a,id:2,value:s.arm[2],label:"theta0"})}),(0,c.jsx)("div",{className:"knob-box",children:(0,c.jsx)(p,{onChange:a,id:3,value:s.arm[3],label:"theta1"})})]})}),(0,c.jsx)("div",{className:"col-lg-4",children:(0,c.jsxs)("div",{className:"indicator",children:[(0,c.jsx)("label",{className:"title",children:"indicator"}),(0,c.jsx)("div",{className:"knob-box",children:(0,c.jsx)(j,{value:50})}),(0,c.jsx)("div",{className:"knob-box",children:(0,c.jsx)(j,{value:50})}),(0,c.jsx)("div",{className:"knob-box",children:(0,c.jsx)(j,{value:50})}),(0,c.jsx)("div",{className:"knob-box",children:(0,c.jsx)(j,{value:50})})]})})]})})]})}),(0,c.jsx)("div",{className:"shape-img2",children:(0,c.jsx)("img",{src:"/images/shape/shape2.svg",alt:"image"})}),(0,c.jsx)("div",{className:"shape-img3",children:(0,c.jsx)("img",{src:"/images/shape/shape3.png",alt:"image"})}),(0,c.jsx)("div",{className:"shape-img4",children:(0,c.jsx)("img",{src:"/images/shape/shape4.svg",alt:"image"})}),(0,c.jsx)("div",{className:"shape-img5",children:(0,c.jsx)("img",{src:"/images/shape/shape5.svg",alt:"image"})}),(0,c.jsx)("div",{className:"shape-img3",children:(0,c.jsx)("img",{src:"/images/shape/shape3.png",alt:"image"})}),(0,c.jsx)("div",{className:"dot-shape1",children:(0,c.jsx)("img",{src:"/images/shape/dot1.png",alt:"image"})}),(0,c.jsx)("div",{className:"dot-shape2",children:(0,c.jsx)("img",{src:"/images/shape/dot3.png",alt:"image"})}),(0,c.jsx)("div",{className:"dot-shape2",children:(0,c.jsx)("img",{src:"/images/shape/dot4.png",alt:"image"})}),(0,c.jsx)("div",{className:"dot-shape2",children:(0,c.jsx)("img",{src:"/images/shape/dot5.png",alt:"image"})}),(0,c.jsx)("div",{className:"dot-shape2",children:(0,c.jsx)("img",{src:"/images/shape/dot6.png",alt:"image"})})]})},N=r(37762),y=r(96894),C={iceServers:[{urls:"turn:3.35.133.246",username:"user",credential:"pass"},{urls:"stun:stun.l.google.com:19302"}]},k=y.d5,w=function(){var e=function(e){console.log("Remote stream added. event.stream?>>>",e.stream),h.current.srcObject=e.stream},n=function(e){console.log("Remote stream removed. Event:",e)},r=(0,i.useRef)(),a=(0,i.useRef)(),l=(0,i.useRef)(),h=(0,i.useRef)(null),f=(0,i.useRef)(),v=(0,i.useState)([]),p=v[0],x=v[1],j=(0,i.useState)([]),y=j[0],w=j[1],S=(0,i.useState)({}),R=(S[0],S[1]),T=(0,i.useState)(),_=(T[0],T[1]),E=function(e,n){console.log("send message(emit msg-v1)",e,n);var s={from:r.current.id,to:n,message:e};r.current.emit("msg-v1",s)},O=function(e,n){console.log("send message(emit msg-v1)",e,n);var s={from:r.current.id,to:n,message:e};r.current.emit("msg-v2",s)},L=function(){var e=(0,s.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(n),r.current.emit("Join_Service",n.sid);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),P=function(e){console.log("Failed to create session description: "+e.toString())},Z=function(){var t=(0,s.Z)(o().mark((function t(c,i){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a.current=new RTCPeerConnection(C),a.current.onicecandidate=function(e){if(e.candidate){if(!r.current)return;console.log("onicecandidate"),E({type:"candidate",label:e.candidate.sdpMLineIndex,id:e.candidate.sdpMid,candidate:e.candidate.candidate},i)}else console.log("End of candidates")},a.current.setRemoteDescription(new RTCSessionDescription(c)),a.current.onaddstream=e,a.current.onremovestream=n,console.log("answer set remote description success",a.current),console.log("sending answer to peer"),a.current.createAnswer().then(function(){var e=(0,s.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.current.setLocalDescription(n);case 2:console.log("setLocalAndSendMessage sending message",n),E(n,i);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),P)}catch(l){console.error(l)}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),D=(0,i.useState)([]),I=D[0],q=D[1];(0,i.useEffect)((function(){q(I.concat({header:"ServiceList",filter:{}}));var n=new Array({header:"ServiceList",filter:{}});return r.current=d()(k,{transports:["websocket"]}),r.current.connected?console.log("connected"):console.log("not conn"),r.current.emit("q_service",n),a.current=new RTCPeerConnection(C),r.current.on("joined",(function(e,n){E("connection request"),console.log("connection request")})),r.current.on("join",(function(e){console.log("Another peer made a request to join room "+e),console.log("This peer is the initiator of room "+e+"!")})),r.current.on("q_result",(function(e){var n=JSON.parse(e);if("ServiceList"===n.header){f.current=n.data,x(n.data);var r=y,s=!0,a=!1,o=void 0;try{for(var c,i=Object.entries(Object(f.current))[Symbol.iterator]();!(s=(c=i.next()).done);s=!0){var l=(0,t.Z)(c.value,2),d=l[0],u=l[1];r=r.concat("".concat(d,":").concat(u.sid))}}catch(m){a=!0,o=m}finally{try{s||null==i.return||i.return()}finally{if(a)throw o}}w(r)}})),r.current.on("msg-v1",function(){var n=(0,s.Z)(o().mark((function n(r){var s,t;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("------------------msg-v1 ",r.message.type,"-------------------"),s=r.message,console.log("msg from:",r.from),console.log("Client received message:",s),l.current=r.from,n.prev=5,"connection request"!==s){n.next=10;break}console.log("check : connection request"),n.next=22;break;case 10:if("offer"!==s.type){n.next=14;break}Z(s,r.from),n.next=22;break;case 14:if("answer"!==s.type){n.next=21;break}if(a.current){n.next=17;break}return n.abrupt("return");case 17:console.log("signalingStat",a.current.signalingState),"stable"!==a.current.signalingState&&(console.log("set the pcRef : ",a.current),a.current.setRemoteDescription(new RTCSessionDescription(s)),a.current.onaddstream=e),n.next=22;break;case 21:"candidate"===s.type&&(t=new RTCIceCandidate({sdpMLineIndex:s.label,candidate:s.candidate}),a.current.addIceCandidate(t));case 22:n.next=27;break;case 24:n.prev=24,n.t0=n.catch(5),console.log("error",n.t0);case 27:case"end":return n.stop()}}),n,null,[[5,24]])})));return function(e){return n.apply(this,arguments)}}()),r.current.on("log",(function(e){console.log(e)})),function(){r.current,a.current}}),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(u.Z,{}),(0,c.jsx)(m.Z,{pageTitle:"Monkey Eye",homePageUrl:"/",homePageText:"Home",activePageText:"Teleoperation",bgImgClass:"item-bg2"}),(0,c.jsx)("div",{className:"base-frame bg-f2f6f9",children:(0,c.jsx)("div",{className:"container",children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-lg-6 col-sm-8",children:(0,c.jsx)("div",{className:"video-area",children:(0,c.jsx)("video",{id:"remotevideo",style:{width:360,height:360,margin:5,backgroundColor:"gray"},ref:h,autoPlay:!0})})}),(0,c.jsx)("div",{className:"col-lg-6 col-sm-8",children:(0,c.jsx)("div",{className:"service-list-area",children:(0,c.jsx)(N.Z,{profileList:p,onProfileSelect:function(e){R(e),L(e),console.log("Selected profile:",e)}})})})]})})}),(0,c.jsx)(b,{onChange:function(e){var n=JSON.stringify({type:"DUP",data:e});_(n),O(n,null),console.log("operate:",n)}}),(0,c.jsx)("button",{onClick:function(){var e=JSON.stringify({type:"CONFIG",data:{record:"START"}});_(e),O(e,null),console.log("operate:",e)},children:"Start Motion recording"}),(0,c.jsx)("button",{onClick:function(){var e=JSON.stringify({type:"CONFIG",data:{record:"WRITE"}});_(e),O(e,null),console.log("operate:",e)},children:"Save Motion recording"}),(0,c.jsx)(g.Z,{})]})},S=w},96894:function(e,n,r){"use strict";r.d(n,{Ki:function(){return t},d5:function(){return s}});var s="https://api.portal301.com/",t="https://13.209.14.100:3333"}},function(e){e.O(0,[1664,5234,1643,1700,9774,2888,179],(function(){return n=43356,e(e.s=n);var n}));var n=e.O();_N_E=n}]);