(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9796],{285:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/webrtc/cast",function(){return r(8003)}])},50:function(e,n,r){"use strict";var t=r(5893),c=r(7294),o=r(1664),a=r.n(o);function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function s(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function u(e,n){return!n||"object"!==d(n)&&"function"!==typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function f(e,n){return f=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},f(e,n)}var d=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function v(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,t=l(e);if(n){var c=l(this).constructor;r=Reflect.construct(t,arguments,c)}else r=t.apply(this,arguments);return u(this,r)}}var p=function(e){!function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&f(e,n)}(l,e);var n,r,c,o=v(l);function l(){return i(this,l),o.apply(this,arguments)}return n=l,(r=[{key:"render",value:function(){var e=this.props,n=e.pageTitle,r=e.homePageUrl,c=e.homePageText,o=e.activePageText,i=e.bgImgClass;return(0,t.jsxs)("div",{className:"page-title-area ".concat(i),children:[(0,t.jsx)("div",{className:"container",children:(0,t.jsxs)("div",{className:"page-title-content",children:[(0,t.jsx)("h2",{children:n}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)(a(),{href:r,children:(0,t.jsx)("a",{children:c})})}),(0,t.jsx)("li",{children:o})]})]})}),(0,t.jsxs)("div",{className:"lines",children:[(0,t.jsx)("div",{className:"line"}),(0,t.jsx)("div",{className:"line"}),(0,t.jsx)("div",{className:"line"})]})]})}}])&&s(n.prototype,r),c&&s(n,c),l}(c.Component);n.Z=p},4119:function(e,n,r){"use strict";r.d(n,{Z:function(){return l}});var t=r(5893),c=r(7294),o=r(986),a=r(461);function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function s(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,c,o=[],a=!0,i=!1;try{for(r=r.call(e);!(a=(t=r.next()).done)&&(o.push(t.value),!n||o.length!==n);a=!0);}catch(s){i=!0,c=s}finally{try{a||null==r.return||r.return()}finally{if(i)throw c}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return i(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(){var e=(0,c.useState)(!0),n=e[0],r=e[1],i=(0,c.useState)(!1),l=i[0],u=i[1],f=s((0,a.Z)(["id"]),2),d=f[0];f[1];(0,c.useEffect)((function(){return"undefined"!==d.id?u(!0):u(!1),document.getElementById("navbar").classList.add("is-sticky"),function(){!1}}),[]);var v=n?"collapse navbar-collapse":"collapse navbar-collapse show",p=n?"navbar-toggler navbar-toggler-right collapsed":"navbar-toggler navbar-toggler-right";return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{id:"navbar",className:"navbar-area",children:(0,t.jsx)("div",{className:"main-nav",children:(0,t.jsx)("div",{className:"container",children:(0,t.jsxs)("nav",{className:"navbar navbar-expand-md navbar-light",children:[(0,t.jsx)(o.Z,{href:"/",children:(0,t.jsxs)("a",{className:"navbar-brand",children:[(0,t.jsx)("img",{src:"/images/main_logo3.png",className:"main-logo",alt:"logo"}),(0,t.jsx)("img",{src:"/images/main_logo3.png",className:"optional-logo",alt:"logo"})]})}),(0,t.jsxs)("button",{onClick:function(){r((function(e){return!e}))},className:p,type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:[(0,t.jsx)("span",{className:"icon-bar top-bar"}),(0,t.jsx)("span",{className:"icon-bar middle-bar"}),(0,t.jsx)("span",{className:"icon-bar bottom-bar"})]}),(0,t.jsxs)("div",{className:v,id:"navbarSupportedContent",children:[(0,t.jsxs)("ul",{className:"navbar-nav",children:[(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(o.Z,{href:"/",activeClassName:"active",children:(0,t.jsx)("a",{className:"nav-link",children:"Home"})})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(o.Z,{href:"/about",activeClassName:"active",children:(0,t.jsx)("a",{className:"nav-link",children:"About Us"})})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(o.Z,{href:"/services",activeClassName:"active",children:(0,t.jsx)("a",{className:"nav-link",children:"Services"})})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(o.Z,{href:"/contact",activeClassName:"active",children:(0,t.jsx)("a",{className:"nav-link",children:"Contact"})})}),!l&&(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(o.Z,{href:"/registration",activeClassName:"active",children:(0,t.jsx)("a",{className:"nav-link",children:"Registration"})})}),l?(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(o.Z,{href:"/logout",activeClassName:"active",children:(0,t.jsx)("a",{className:"nav-link",children:"Log Out"})})}):(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(o.Z,{href:"/login",activeClassName:"active",children:(0,t.jsx)("a",{className:"nav-link",children:"Log In"})})})]}),(0,t.jsx)("div",{className:"others-options"})]})]})})})})})}},8003:function(e,n,r){"use strict";r.r(n),r.d(n,{App:function(){return x}});var t=r(4051),c=r.n(t),o=r(5893),a=r(7294),i=r(6809),s=r.n(i),l=r(4119),u=r(50),f=r(6866);function d(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function v(e,n,r,t,c,o,a){try{var i=e[o](a),s=i.value}catch(l){return void r(l)}i.done?n(s):Promise.resolve(s).then(t,c)}function p(e){return function(){var n=this,r=arguments;return new Promise((function(t,c){var o=e.apply(n,r);function a(e){v(o,t,c,a,i,"next",e)}function i(e){v(o,t,c,a,i,"throw",e)}a(void 0)}))}}function g(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){g(e,n,r[n])}))}return e}function h(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,c,o=[],a=!0,i=!1;try{for(r=r.call(e);!(a=(t=r.next()).done)&&(o.push(t.value),!n||o.length!==n);a=!0);}catch(s){i=!0,c=s}finally{try{a||null==r.return||r.return()}finally{if(i)throw c}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return d(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var b={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},x=function(){var e=function(e){console.log("Remote stream added. event.stream?>>>",e.stream),v.current.srcObject=e.stream},n=(0,a.useRef)(),r=(0,a.useRef)(),t=(0,a.useRef)({}),i=(0,a.useRef)(),d=(0,a.useRef)(null),v=(0,a.useRef)(null),x=(0,a.useRef)(),y=(0,a.useRef)(),j=(0,a.useRef)(),w=(0,a.useState)([]),S=w[0],k=w[1],N=function(e,r){console.log("send message(emit msg-v1)",e.type,r);var t={from:n.current.id,to:r,message:e};n.current.emit("msg-v1",t)},C=function(){var e=p(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:t=e.sent,d.current&&(d.current.srcObject=t),t.getTracks().forEach((function(e){r.current&&r.current.addTrack(e,t)})),n.current.emit("Start_Service",{socketId:n.current.id,room:"room:"+n.current.id,type:"Device_1",description:"Streamer",contents:"jooonik"}),N("got user media",null),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),O=(function(){var e=p(c().mark((function e(){var t,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("create offer"),t=j.current.find((function(e){return e.sid===y.current})),console.log(t),console.log(t),n.current.emit("Join_Service",t.sid),e.prev=5,e.next=8,r.current.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 8:return o=e.sent,e.next=11,r.current.setLocalDescription(new RTCSessionDescription(o));case 11:console.log(r.current.iceGatheringState),r.current.oniceconnectionstatechange=function(e){console.log("oniceconnectionstatechange : ",e.target.connectionState)},N(o,t.sid),i.current=t.sid,e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),console.log("errrrrrrrrr"),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[5,17]])})))}(),function(){var e=p(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.current.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 3:return t=e.sent,e.next=6,r.current.setLocalDescription(new RTCSessionDescription(t));case 6:console.log(r.current.iceGatheringState),r.current.oniceconnectionstatechange=function(e){console.log("oniceconnectionstatechange : ",e.target.connectionState)},N(t,i.current),n.current.emit("offer",t),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("errrrrrrrrr"),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}()),R=function(e){console.log("Failed to create session description: "+e.toString())},_=function(){var e=p(c().mark((function e(o,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.current[a]=new RTCPeerConnection(b),r.current.onicecandidate=function(e){if(e.candidate){if(!n.current)return;console.log("onicecandidate"),N({type:"candidate",label:e.candidate.sdpMLineIndex,id:e.candidate.sdpMid,candidate:e.candidate.candidate},a)}},r.current.oniceconnectionstatechange=function(e){console.log("oniceconnectionstatechange : ",e.target.connectionState)},t.current=m({},t.current,g({},a,r.current)),e.next=7,t.current[a].setRemoteDescription(new RTCSessionDescription(o));case 7:console.log("answer set remote description success",t.current),t.current[a].createAnswer().then(function(){var e=p(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.current[a].setLocalDescription(n);case 2:console.log("setLocalAndSendMessage sending message",n),N(n,a);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),R),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,r){return e.apply(this,arguments)}}(),T=(0,a.useState)([]),P=T[0],A=T[1];(0,a.useEffect)((function(){A(P.concat({header:"ServiceList",filter:{}}));var t=new Array({header:"ServiceList",filter:{}});return n.current=s()("https://192.168.0.12:3333",{transports:["websocket"]}),n.current.connected?console.log("connected"):console.log("not conn"),n.current.emit("q_service",t),r.current=new RTCPeerConnection(b),x.current={socketId:n.current.id,room:"room:"+n.current.id,type:"Device_1",description:"Streamer",contents:"jooonik"},n.current.on("all_users",(function(e){console.log("alluser",e.length,e)})),n.current.on("user-connected",(function(e){console.log('"user-connected"',e)})),n.current.on("getOffer",(function(e){console.log("get offer"),_(e)})),n.current.on("getAnswer",(function(n){console.log("get answer"),r.current&&(r.current.setRemoteDescription(new RTCSessionDescription(n)),r.current.onaddstream=e)})),n.current.on("getCandidate",function(){var e=p(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.current){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.current.addIceCandidate(new RTCIceCandidate(n));case 4:console.log("candidate add success");case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),n.current.on("joined",(function(e,n){O(),console.log("joined!")})),n.current.on("join",(function(e){console.log("Another peer made a request to join room "+e),console.log("This peer is the initiator of room "+e+"!")})),n.current.on("q_result",(function(e){var n=JSON.parse(e);if("ServiceList"===n.header){j.current=n.data;var r=S,t=!0,c=!1,o=void 0;try{for(var a,i=Object.entries(Object(j.current))[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var s=h(a.value,2),l=s[0],u=s[1];r=r.concat("".concat(l,":").concat(u.sid))}}catch(f){c=!0,o=f}finally{try{t||null==i.return||i.return()}finally{if(c)throw o}}k(r)}})),n.current.on("msg-v1",function(){var n=p(c().mark((function n(t){var o;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("------------------msg-v1 ",t.message.type,"-------------------"),o=t.message,console.log("msg from",t.from),console.log("Client received message:",o),i.current=t.from,n.prev=5,"connection request"!==o){n.next=10;break}console.log("check : connection request"),n.next=23;break;case 10:if("offer"!==o.type){n.next=14;break}console.log("check : offer",o),_(o,t.from),n.next=23;break;case 14:if("answer"!==o.type){n.next=22;break}if(r.current){n.next=17;break}return n.abrupt("return");case 17:console.log("signalingStat",r.current.signalingState),"stable"!==r.current.signalingState&&(console.log("set the pcRef : ",r.current),r.current.setRemoteDescription(new RTCSessionDescription(o)),r.current.onaddstream=e),console.log("set the pcRef2 : ",r.current),n.next=23;break;case 22:"candidate"===o.type&&console.log("check : candi");case 23:n.next=28;break;case 25:n.prev=25,n.t0=n.catch(5),console.log("eeeeeeeeeeee",n.t0);case 28:case"end":return n.stop()}}),n,null,[[5,25]])})));return function(e){return n.apply(this,arguments)}}()),function(){n.current,r.current}}),[]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.Z,{}),(0,o.jsx)(u.Z,{pageTitle:"Security & Surveillance",homePageUrl:"/",homePageText:"Home",activePageText:"Service Details",bgImgClass:"item-bg2"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("video",{style:{width:240,height:240,margin:5,backgroundColor:"black"},muted:!0,ref:d,autoPlay:!0}),(0,o.jsx)("button",{onClick:C,children:"Start Streaming"}),(0,o.jsx)("button",{onClick:function(){O(i.current),console.log(r.current.iceGatheringState)},children:"console debug"}),(0,o.jsx)("select",{onChange:function(e){console.log(e.target.value),y.current=e.target.value},value:y.current,children:S.map((function(e){return(0,o.jsx)("option",{value:e.split(":")[1],children:e},e)}))})]}),(0,o.jsx)(f.Z,{})]})};n.default=x},7020:function(){}},function(e){e.O(0,[5637,6809,1309,9774,2888,179],(function(){return n=285,e(e.s=n);var n}));var n=e.O();_N_E=n}]);