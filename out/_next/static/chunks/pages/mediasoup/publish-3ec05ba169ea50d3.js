(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5814],{4807:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mediasoup/publish",function(){return r(2251)}])},3538:function(e,n,r){"use strict";var t=r(1438),c=r(2951),a=r(8029),s=r(5950),o=r(5893),i=r(7294),l=r(1664),u=r.n(l),d=function(e){(0,a.Z)(r,e);var n=(0,s.Z)(r);function r(){return(0,t.Z)(this,r),n.apply(this,arguments)}return(0,c.Z)(r,[{key:"render",value:function(){var e=this.props,n=e.pageTitle,r=e.homePageUrl,t=e.homePageText,c=e.activePageText,a=e.bgImgClass;return(0,o.jsxs)("div",{className:"page-title-area ".concat(a),children:[(0,o.jsx)("div",{className:"container",children:(0,o.jsxs)("div",{className:"page-title-content",children:[(0,o.jsx)("h2",{children:n}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:(0,o.jsx)(u(),{href:r,children:(0,o.jsx)("a",{children:t})})}),(0,o.jsx)("li",{children:c})]})]})}),(0,o.jsxs)("div",{className:"lines",children:[(0,o.jsx)("div",{className:"line"}),(0,o.jsx)("div",{className:"line"}),(0,o.jsx)("div",{className:"line"})]})]})}}]),r}(i.Component);n.Z=d},8348:function(e,n,r){"use strict";var t=r(1438),c=r(2951),a=r(8029),s=r(5950),o=r(5893),i=r(7294),l=r(1664),u=r.n(l),d=function(e){(0,a.Z)(r,e);var n=(0,s.Z)(r);function r(){return(0,t.Z)(this,r),n.apply(this,arguments)}return(0,c.Z)(r,[{key:"render",value:function(){(new Date).getFullYear();return(0,o.jsxs)("footer",{className:"footer-area",children:[(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsx)("div",{className:"col-md-12",children:(0,o.jsx)("div",{className:"single-footer-widget",children:(0,o.jsxs)("div",{className:"footer-contact-list",children:[(0,o.jsx)("div",{className:"title",children:"Contacts"}),(0,o.jsxs)("div",{className:"info",children:[(0,o.jsx)("strong",{children:"Email:"})," jangjun_park@portal301.com"]}),(0,o.jsxs)("div",{className:"info",children:[(0,o.jsx)("strong",{children:"Phone:"})," +82 10-5609-9527"]})]})})})})}),(0,o.jsx)("div",{className:"copyright-area",children:(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row align-items-center",children:(0,o.jsx)("div",{className:"col-md-12",children:(0,o.jsx)("ul",{children:(0,o.jsx)("li",{children:(0,o.jsx)(u(),{href:"/",children:(0,o.jsx)("a",{children:"\xa9 Copyright PORTAL301 All Rights Reserved."})})})})})})})})]})}}]),r}(i.Component);n.Z=d},4108:function(e,n,r){"use strict";r.d(n,{Z:function(){return d}});var t=r(828),c=r(2222),a=r(5893),s=r(7294),o=r(3823),i=r(461),l=r(9473),u=r(2505);function d(){var e=(0,l.I0)(),n=(0,l.v9)(u.h5),r=(0,s.useRef)(),d=(0,l.v9)(u.L4),h=(0,s.useState)(!0),p=h[0],m=h[1],v=(0,t.Z)((0,i.Z)(["id","nickname"]),2),f=v[0];v[1];(0,s.useEffect)((function(){return console.log("cookies.id:",f.id),"undefined"===f.id&&console.log("aaaaaaaaa",(0,c.Z)(f.id)),void 0===f.id||"undefined"===f.id?(r.current=!1,e((0,u.Q2)(!1)),e((0,u.vm)("")),e((0,u.ng)(""))):(r.current=!0,e((0,u.Q2)(!0)),e((0,u.vm)(f.id)),e((0,u.ng)(f.nickname))),console.log("is?",r.current),document.getElementById("navbar").classList.add("is-sticky"),function(){!1}}),[]);var g=p?"collapse navbar-collapse":"collapse navbar-collapse show",x=p?"navbar-toggler navbar-toggler-right collapsed":"navbar-toggler navbar-toggler-right";return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{id:"navbar",className:"navbar-area",children:(0,a.jsx)("div",{className:"main-nav",children:(0,a.jsx)("div",{className:"container",children:(0,a.jsxs)("div",{className:"navbar navbar-expand-md navbar-light",children:[(0,a.jsx)(o.Z,{href:"/",children:(0,a.jsxs)("a",{className:"navbar-brand",children:[(0,a.jsx)("img",{src:"/images/main_bar.png",className:"main-bar",alt:"logo"}),(0,a.jsx)("img",{src:"/images/main_logo3.png",className:"optional-logo",alt:"logo"})]})}),(0,a.jsxs)("button",{onClick:function(){m((function(e){return!e}))},className:x,type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:[(0,a.jsx)("span",{className:"icon-bar top-bar"}),(0,a.jsx)("span",{className:"icon-bar middle-bar"}),(0,a.jsx)("span",{className:"icon-bar bottom-bar"})]}),(0,a.jsxs)("div",{className:g,id:"navbarSupportedContent",children:[(0,a.jsxs)("ul",{className:"navbar-nav",children:[!1===n?(0,a.jsx)("li",{className:"nav-item",children:(0,a.jsx)(o.Z,{href:"/registration",activeClassName:"active",children:(0,a.jsx)("a",{className:"nav-link",children:"Registration"})})}):(0,a.jsx)("li",{className:"nav-item",children:(0,a.jsx)(o.Z,{href:"/mypage",activeClassName:"active",children:(0,a.jsxs)("a",{className:"nav-link",children:[d,"\ub2d8"]})})}),!1===n?(0,a.jsx)("li",{className:"nav-item",children:(0,a.jsx)(o.Z,{href:"/login",activeClassName:"active",children:(0,a.jsx)("a",{className:"nav-link",children:"Log In"})})}):(0,a.jsx)("li",{className:"nav-item",children:(0,a.jsx)(o.Z,{href:"/logout",activeClassName:"active",children:(0,a.jsx)("a",{className:"nav-link",children:"Log Out"})})})]}),(0,a.jsx)("div",{className:"others-options"})]})]})})})})})}},2251:function(e,n,r){"use strict";r.r(n);var t=r(7568),c=r(4051),a=r.n(c),s=r(5893),o=r(7294),i=r(960),l=r(6809),u=r.n(l),d=r(6894),h=(r(8584),r(4108)),p=r(3538),m=r(8348);n.default=function(e){var n,r=function(e){e.pause(),e.srcObject=null},c=function(e){var n=e.getTracks();n?n.forEach((function(e){return e.stop()})):console.warn("NO tracks")},l=function(){w.current&&(w.current.close(),w.current=null,x.current=null,console.log("socket.io closed.."))},v=function(e,n){return new Promise((function(r,t){w.current.emit(e,n,(function(e,n){e?t(e):r(n)}))}))},f=(0,o.useRef)(),g=(0,o.useRef)(),x=(0,o.useRef)(),j=(0,o.useRef)(),b=(0,o.useRef)(),N=(0,o.useRef)(),k=(0,o.useRef)(),w=(0,o.useRef)(),R=(0,o.useState)(!0),Z=R[0],C=R[1],y=(0,o.useState)(!0),P=y[0],T=y[1],E=(0,o.useState)(!1),_=E[0],S=E[1],O=(0,o.useState)(!1),A=O[0],I=O[1];function D(){return D=(0,t.Z)(a().mark((function e(){var n,r,c,s,o,i,l,u,d,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.current){e.next=3;break}return console.warn("WARN: local media NOT READY"),e.abrupt("return");case 3:if(w.current){e.next=6;break}return e.next=6,M().catch((function(e){console.error(e)}));case 6:return e.next=8,v("createRoom",{streamer:x.current});case 8:return n=e.sent,console.log("response msg from server >>",n),e.next=12,v("makeRouter",x.current);case 12:return r=e.sent,c=r.targetRouterrouter,s=r.allRouters,console.log("targetRouterrouter?",c),console.log("allRouters?",s),e.next=19,v("getRouterRtpCapabilities",x.current);case 19:return o=e.sent,console.log("getRouterRtpCapabilities:",o),e.next=23,L(o);case 23:return console.log("--- createProducerTransport --"),e.next=26,v("createProducerTransport",x.current);case 26:if(i=e.sent,console.log("transport params:",i),b.current=j.current.createSendTransport(i),console.log("createSendTransport:",b),b.current.on("connect",function(){var e=(0,t.Z)(a().mark((function e(n,r,t){var c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=n.dtlsParameters,console.log("--trasnport connect"),v("connectProducerTransport",{dtlsParameters:c,socketid:x.current}).then(r).catch(t);case 3:case"end":return e.stop()}}),e)})));return function(n,r,t){return e.apply(this,arguments)}}()),b.current.on("produce",function(){var e=(0,t.Z)(a().mark((function e(n,r,t){var c,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.kind,s=n.rtpParameters,console.log("--trasnport produce"),e.prev=2,e.next=5,v("produce",{socketid:x.current,transportId:b.current.id,kind:c,rtpParameters:s});case 5:o=e.sent.id,r({id:o}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(n,r,t){return e.apply(this,arguments)}}()),b.current.on("connectionstatechange",(function(e){switch(e){case"connecting":console.log("publishing...");break;case"connected":console.log("published"),I(!0);break;case"failed":console.log("failed"),b.current.close()}})),!Z){e.next=40;break}if(!(l=g.current.getVideoTracks()[0])){e.next=40;break}return u={track:l},e.next=39,b.current.produce(u);case 39:N.current=e.sent;case 40:if(!P){e.next=47;break}if(!(d=g.current.getAudioTracks()[0])){e.next=47;break}return h={track:d},e.next=46,b.current.produce(h);case 46:k.current=e.sent;case 47:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}(0,o.useEffect)((function(){M()}),[]);var L=function(){var e=(0,t.Z)(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{j.current=new i.Device,console.log("device.current"),console.log(j.current)}catch(r){"UnsupportedError"===r.name&&console.error("browser not supported")}return console.log("device.current start"),console.log(j.current),console.log("device.current end"),e.next=6,j.current.load({routerRtpCapabilities:n});case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),M=function(){return w.current=u()(d.Ki,{transports:["websocket"]}),new Promise((function(e,r){(n=w.current).on("connect",(function(e){console.log("socket.io connected()")})),n.on("error",(function(e){console.error("socket.io ERROR:",e),r(e)})),n.on("message",(function(r){console.log("socket.io message:",r),"welcome"===r.type?(n.id!==r.id&&console.warn("WARN: something wrong with clientID",n.io,r.id),x.current=r.id,console.log("connected to server. clientId="+x.current),e()):console.error("UNKNOWN message from server:",r)})),n.on("newProducer",function(){var e=(0,t.Z)(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.warn("IGNORE socket.io newProducer:",n);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{}),(0,s.jsx)(p.Z,{pageTitle:"MediaSoup",homePageUrl:"/",homePageText:"MediaSoup",activePageText:"Publish",bgImgClass:"item-bg2"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{disabled:_,onChange:function(e){C(!Z)},type:"checkbox",checked:Z}),(0,s.jsx)("label",{children:"video"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{disabled:_,onChange:function(e){T(!P)},type:"checkbox",checked:P}),(0,s.jsx)("label",{children:"audio"})]}),(0,s.jsx)("button",{disabled:_,onClick:function(){g.current?console.warn("WARN: local media ALREADY started"):navigator.mediaDevices.getUserMedia({audio:P,video:Z}).then((function(e){g.current=e,function(e,n){if(!e.srcObject)return e.srcObject=n,e.volume=0,e.play();console.warn("element ALREADY playing, so ignore")}(f.current,g.current),S(!0)})).catch((function(e){console.error("media ERROR:",e)}))},children:"Start Media"}),(0,s.jsx)("button",{disabled:!_||A,onClick:function(){g.current&&(r(f.current),c(g.current),g.current=null,S(!1))},children:"Stop Media"}),(0,s.jsx)("button",{disabled:A||!_,onClick:function(){return D.apply(this,arguments)},children:"publish"}),(0,s.jsx)("button",{disabled:!A||!_,onClick:function(){g.current&&(r(f.current),c(g.current),g.current=null),N.current&&(N.current.close(),N.current=null),k.current&&(k.current.close(),k.current=null),b.current&&(b.current.close(),b.current=null),l(),I(!1),S(!1)},children:"Disconnect"}),(0,s.jsxs)("div",{children:["local video",(0,s.jsx)("video",{ref:f,autoPlay:!0,style:{width:"240px",height:"180px",border:"1px solid black"}})]})]}),(0,s.jsx)(m.Z,{})]})}},6894:function(e,n,r){"use strict";r.d(n,{Ki:function(){return c},d5:function(){return t}});var t="https://api.portal301.com/",c="https://13.124.32.140:3333"},3823:function(e,n,r){"use strict";var t=r(6042),c=r(9396),a=r(9534),s=r(5893),o=r(1163),i=r(1664),l=r.n(i),u=r(7294);n.Z=(0,o.withRouter)((function(e){var n=e.router,r=e.children,o=(0,a.Z)(e,["router","children"]),i=u.Children.only(r),d=i.props.className||"";return n.pathname===o.href&&o.activeClassName&&(d="".concat(d," ").concat(o.activeClassName).trim()),delete o.activeClassName,(0,s.jsx)(l(),(0,c.Z)((0,t.Z)({},o),{children:u.cloneElement(i,{className:d})}))}))},7020:function(){}},function(e){e.O(0,[1664,5234,5077,9774,2888,179],(function(){return n=4807,e(e.s=n);var n}));var n=e.O();_N_E=n}]);