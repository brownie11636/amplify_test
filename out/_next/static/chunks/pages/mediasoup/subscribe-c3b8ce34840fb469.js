(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1469],{91958:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mediasoup/subscribe",function(){return r(68865)}])},73538:function(e,n,r){"use strict";var t=r(51438),s=r(52951),c=r(88029),a=r(5950),o=r(85893),i=r(67294),l=r(41664),u=r.n(l),d=function(e){(0,c.Z)(r,e);var n=(0,a.Z)(r);function r(){return(0,t.Z)(this,r),n.apply(this,arguments)}return(0,s.Z)(r,[{key:"render",value:function(){var e=this.props,n=e.pageTitle,r=e.homePageUrl,t=e.homePageText,s=e.activePageText,c=e.bgImgClass;return(0,o.jsxs)("div",{className:"page-title-area ".concat(c),children:[(0,o.jsx)("div",{className:"container",children:(0,o.jsxs)("div",{className:"page-title-content",children:[(0,o.jsx)("h2",{children:n}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:(0,o.jsx)(u(),{href:r,children:(0,o.jsx)("a",{children:t})})}),(0,o.jsx)("li",{children:s})]})]})}),(0,o.jsxs)("div",{className:"lines",children:[(0,o.jsx)("div",{className:"line"}),(0,o.jsx)("div",{className:"line"}),(0,o.jsx)("div",{className:"line"})]})]})}}]),r}(i.Component);n.Z=d},78348:function(e,n,r){"use strict";var t=r(51438),s=r(52951),c=r(88029),a=r(5950),o=r(85893),i=r(67294),l=r(41664),u=r.n(l),d=function(e){(0,c.Z)(r,e);var n=(0,a.Z)(r);function r(){return(0,t.Z)(this,r),n.apply(this,arguments)}return(0,s.Z)(r,[{key:"render",value:function(){(new Date).getFullYear();return(0,o.jsxs)("footer",{className:"footer-area",children:[(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsx)("div",{className:"col-md-12",children:(0,o.jsx)("div",{className:"single-footer-widget",children:(0,o.jsxs)("div",{className:"footer-contact-list",children:[(0,o.jsx)("div",{className:"title",children:"Contacts"}),(0,o.jsxs)("div",{className:"info",children:[(0,o.jsx)("strong",{children:"Email:"})," jangjun_park@portal301.com"]}),(0,o.jsxs)("div",{className:"info",children:[(0,o.jsx)("strong",{children:"Phone:"})," +82 10-5609-9527"]})]})})})})}),(0,o.jsx)("div",{className:"copyright-area",children:(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row align-items-center",children:(0,o.jsx)("div",{className:"col-md-12",children:(0,o.jsx)("ul",{children:(0,o.jsx)("li",{children:(0,o.jsx)(u(),{href:"/",children:(0,o.jsx)("a",{children:"\xa9 Copyright PORTAL301 All Rights Reserved."})})})})})})})})]})}}]),r}(i.Component);n.Z=d},44108:function(e,n,r){"use strict";r.d(n,{Z:function(){return d}});var t=r(828),s=r(82222),c=r(85893),a=r(67294),o=r(13823),i=r(70461),l=r(9473),u=r(32505);function d(){var e=(0,l.I0)(),n=(0,l.v9)(u.h5),r=(0,a.useRef)(),d=(0,l.v9)(u.L4),m=(0,a.useState)(!0),p=m[0],f=m[1],h=(0,t.Z)((0,i.Z)(["id","nickname"]),2),v=h[0];h[1];(0,a.useEffect)((function(){return console.log("cookies.id:",v.id),"undefined"===v.id&&console.log("aaaaaaaaa",(0,s.Z)(v.id)),void 0===v.id||"undefined"===v.id?(r.current=!1,e((0,u.Q2)(!1)),e((0,u.vm)("")),e((0,u.ng)(""))):(r.current=!0,e((0,u.Q2)(!0)),e((0,u.vm)(v.id)),e((0,u.ng)(v.nickname))),console.log("is?",r.current),document.getElementById("navbar").classList.add("is-sticky"),function(){!1}}),[]);var x=p?"collapse navbar-collapse":"collapse navbar-collapse show",g=p?"navbar-toggler navbar-toggler-right collapsed":"navbar-toggler navbar-toggler-right";return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{id:"navbar",className:"navbar-area",children:(0,c.jsx)("div",{className:"main-nav",children:(0,c.jsx)("div",{className:"container",children:(0,c.jsxs)("div",{className:"navbar navbar-expand-md navbar-light",children:[(0,c.jsx)(o.Z,{href:"/",children:(0,c.jsxs)("a",{className:"navbar-brand",children:[(0,c.jsx)("img",{src:"/images/main_bar.png",className:"main-bar",alt:"logo"}),(0,c.jsx)("img",{src:"/images/main_logo3.png",className:"optional-logo",alt:"logo"})]})}),(0,c.jsxs)("button",{onClick:function(){f((function(e){return!e}))},className:g,type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:[(0,c.jsx)("span",{className:"icon-bar top-bar"}),(0,c.jsx)("span",{className:"icon-bar middle-bar"}),(0,c.jsx)("span",{className:"icon-bar bottom-bar"})]}),(0,c.jsxs)("div",{className:x,id:"navbarSupportedContent",children:[(0,c.jsxs)("ul",{className:"navbar-nav",children:[!1===n?(0,c.jsx)("li",{className:"nav-item",children:(0,c.jsx)(o.Z,{href:"/registration",activeClassName:"active",children:(0,c.jsx)("a",{className:"nav-link",children:"Registration"})})}):(0,c.jsx)("li",{className:"nav-item",children:(0,c.jsx)(o.Z,{href:"/mypage",activeClassName:"active",children:(0,c.jsxs)("a",{className:"nav-link",children:[d,"\ub2d8"]})})}),!1===n?(0,c.jsx)("li",{className:"nav-item",children:(0,c.jsx)(o.Z,{href:"/login",activeClassName:"active",children:(0,c.jsx)("a",{className:"nav-link",children:"Log In"})})}):(0,c.jsx)("li",{className:"nav-item",children:(0,c.jsx)(o.Z,{href:"/logout",activeClassName:"active",children:(0,c.jsx)("a",{className:"nav-link",children:"Log Out"})})})]}),(0,c.jsx)("div",{className:"others-options"})]})]})})})})})}},68865:function(e,n,r){"use strict";r.r(n);var t=r(47568),s=r(828),c=r(34051),a=r.n(c),o=r(85893),i=r(67294),l=r(50960),u=r(86809),d=r.n(u),m=r(96894),p=r(44108),f=r(73538),h=r(78348);n.default=function(e){var n=function(e){console.log("list Update..."),C.current=e;var n=O,r=!0,t=!1,c=void 0;try{for(var a,o=Object.entries(Object(C.current))[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var i=(0,s.Z)(a.value,2),l=i[0],u=i[1];n=n.concat("".concat(l,":").concat(u.socketid))}}catch(d){t=!0,c=d}finally{try{r||null==o.return||o.return()}finally{if(t)throw c}}P((function(e){return n}))},r=function(e,n){var r=v.current;if(r.srcObject)r.srcObject.addTrack(n);else{var t=new MediaStream;t.addTrack(n),function(e,n){if(!e.srcObject)return e.srcObject=n,e.volume=0,v.current=e,console.log("playVideo"),console.log(v),e.play();console.warn("element ALREADY playing, so ignore")}(r,t).then((function(){r.volume=1})).catch((function(e){console.error("media ERROR:",e)}))}},c=function(e,n){return new Promise((function(r,t){N.current.emit(e,n,(function(e,n){e?t(e):r(n)}))}))},u=function(){v.current&&(v.current.pause(),v.current.srcObject=null)},v=(0,i.useRef)(),x=((0,i.useRef)(),(0,i.useRef)()),g=(0,i.useRef)(),j=(0,i.useRef)(),b=(0,i.useRef)(),k=(0,i.useRef)(),N=(0,i.useRef)(),w=(0,i.useState)(""),y=w[0],R=w[1],C=(0,i.useRef)(),Z=(0,i.useState)([]),O=Z[0],P=Z[1],T=(0,i.useState)(!1),E=T[0],S=T[1],_=(0,i.useState)(!1);function I(){return I=(0,t.Z)(a().mark((function e(){var n,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N.current){e.next=3;break}return e.next=3,M().catch((function(e){console.error(e)}));case 3:return n=y,e.next=6,c("getRouterRtpCapabilities",n);case 6:return r=e.sent,console.log("getRouterRtpCapabilities:",r),e.next=10,D(r);case 10:return console.log("--- createConsumerTransport --"),e.next=13,c("createConsumerTransport",{socketid:n});case 13:return s=e.sent,console.log("transport params:",s),j.current=g.current.createRecvTransport(s),console.log("createConsumerTransport:",j),j.current.on("connect",function(){var e=(0,t.Z)(a().mark((function e(n,r,t){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.dtlsParameters,console.log("--consumer trasnport connect"),c("connectConsumerTransport",{dtlsParameters:s}).then(r).catch(t);case 3:case"end":return e.stop()}}),e)})));return function(n,r,t){return e.apply(this,arguments)}}()),j.current.on("connectionstatechange",(function(e){switch(e){case"connecting":console.log("subscribing...");break;case"connected":console.log("subscribed"),S(!0);break;case"failed":console.log("failed"),j.current.close()}})),e.next=21,L(j.current,"video");case 21:return b.current=e.sent,e.next=24,L(j.current,"audio");case 24:k.current=e.sent;case 25:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function L(e,n){return A.apply(this,arguments)}function A(){return(A=(0,t.Z)(a().mark((function e(n,r){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(n,r);case 2:if(!(t=e.sent)){e.next=7;break}console.log("-- track exist, consumer ready. kind="+r),"video"===r?(console.log("-- resume kind="+r),c("resume",{kind:r}).then((function(){return console.log("resume OK"),t})).catch((function(e){return console.error("resume ERROR:",e),t}))):console.log("-- do not resume kind="+r),e.next=9;break;case 7:return console.log("-- no consumer yet. kind="+r),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return U.apply(this,arguments)}function U(){return(U=(0,t.Z)(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{g.current=new l.Device}catch(r){"UnsupportedError"===r.name&&console.error("browser not supported")}return e.next=3,g.current.load({routerRtpCapabilities:n});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,n){return F.apply(this,arguments)}function F(){return(F=(0,t.Z)(a().mark((function e(n,t){var s,o,i,l,u,d,m,p,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("--start of consume --kind="+t),s=y,o=g.current.rtpCapabilities,e.next=5,c("consume",{rtpCapabilities:o,kind:t,socketid:s}).catch((function(e){console.error("consume ERROR:",e)}));case 5:if(i=e.sent,l=i.producerId,u=i.id,d=i.kind,m=i.rtpParameters,!l){e.next=17;break}return p={},e.next=11,n.consume({id:u,producerId:l,kind:d,rtpParameters:m,codecOptions:p});case 11:return f=e.sent,r(x.current,f.track),console.log("--end of consume"),e.abrupt("return",f);case 17:return console.warn("--- remote producer NOT READY"),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}_[0],_[1],(0,i.useEffect)((function(){function e(){return(e=(0,t.Z)(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c("serviceList",{});case 2:r=e.sent.allRouters,console.log("allrouters?",r),n(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}M(),function(){e.apply(this,arguments)}()}),[]);var M=function(){return N.current=d()(m.Ki,{transports:["websocket"]}),new Promise((function(e,r){var s=N.current;s.on("listUpdate",(function(e){n(e)})),s.on("connect",(function(e){console.log("socket.io connected()")})),s.on("error",(function(e){console.error("socket.io ERROR:",e),r(e)})),s.on("message",(function(n){console.log("socket.io message:",n),"welcome"===n.type?(s.id!==n.id&&console.warn("WARN: something wrong with clientID",s.io,n.id),x.current=n.id,console.log("connected to server. clientId="+x.current),e()):console.error("UNKNOWN message from server:",n)})),s.on("newProducer",function(){var e=(0,t.Z)(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("socket.io newProducer:",n),!j.current){e.next=12;break}if("video"!==n.kind){e.next=8;break}return e.next=5,L(j.current,n.kind);case 5:b.current=e.sent,e.next=12;break;case 8:if("audio"!==n.kind){e.next=12;break}return e.next=11,L(j.current,n.kind);case 11:k.current=e.sent;case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),s.on("producerClosed",(function(e){console.log("socket.io producerClosed:",e);var n,r=e.localId,t=e.remoteId,s=e.kind;console.log("--try removeConsumer remoteId="+t+", localId="+r+", kind="+s),"video"===s?b.current&&(b.current.close(),b.current=null):"audio"===s&&k.current&&(k.current.close(),k.current=null),t?(n=t,console.log(" ---- removeRemoteVideo() id="+n)):u()}))}))};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(p.Z,{}),(0,o.jsx)(f.Z,{pageTitle:"MediaSoup",homePageUrl:"/",homePageText:"MediaSoup",activePageText:"Subscribe",bgImgClass:"item-bg2"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{disabled:E,onClick:function(){return I.apply(this,arguments)},children:"Subscribe"}),(0,o.jsx)("button",{disabled:!E,onClick:function(){b.current&&(b.current.close(),b.current=null),k.current&&(k.current.close(),k.current=null),j.current&&(j.current.close(),j.current=null),u(),S(!1)},children:"Disconnect"}),(0,o.jsxs)("div",{children:["remote video",(0,o.jsx)("br",{}),(0,o.jsx)("div",{children:(0,o.jsx)("video",{ref:v,autoPlay:!0,style:{width:"240px",height:"180px",border:"1px solid black"}})}),(0,o.jsxs)("select",{onChange:function(e){console.log("handleSelected? >>",e.target.value),R(e.target.value)},value:y,children:[(0,o.jsx)("option",{value:"null",children:"=== \uc2a4\ud2b8\ub9ac\uba38 \uc120\ud0dd ==="}),O.map((function(e){return(0,o.jsx)("option",{value:e.split(":")[1],children:e},e)}))]})]})]}),(0,o.jsx)(h.Z,{})]})}},96894:function(e,n,r){"use strict";r.d(n,{Ki:function(){return s},d5:function(){return t}});var t="https://api.portal301.com/",s="https://13.209.14.100:3333"},13823:function(e,n,r){"use strict";var t=r(26042),s=r(69396),c=r(99534),a=r(85893),o=r(11163),i=r(41664),l=r.n(i),u=r(67294);n.Z=(0,o.withRouter)((function(e){var n=e.router,r=e.children,o=(0,c.Z)(e,["router","children"]),i=u.Children.only(r),d=i.props.className||"";return n.pathname===o.href&&o.activeClassName&&(d="".concat(d," ").concat(o.activeClassName).trim()),delete o.activeClassName,(0,a.jsx)(l(),(0,s.Z)((0,t.Z)({},o),{children:u.cloneElement(i,{className:d})}))}))},77020:function(){}},function(e){e.O(0,[1664,5234,5077,9774,2888,179],(function(){return n=91958,e(e.s=n);var n}));var n=e.O();_N_E=n}]);