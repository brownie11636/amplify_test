(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5814],{74807:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mediasoup/publish",function(){return r(12251)}])},73538:function(e,n,r){"use strict";var t=r(51438),c=r(52951),s=r(88029),a=r(5950),o=r(85893),i=r(67294),l=r(41664),u=r.n(l),d=function(e){(0,s.Z)(r,e);var n=(0,a.Z)(r);function r(){return(0,t.Z)(this,r),n.apply(this,arguments)}return(0,c.Z)(r,[{key:"render",value:function(){var e=this.props,n=e.pageTitle,r=e.homePageUrl,t=e.homePageText,c=e.activePageText,s=e.bgImgClass;return(0,o.jsxs)("div",{className:"page-title-area ".concat(s),children:[(0,o.jsx)("div",{className:"container",children:(0,o.jsxs)("div",{className:"page-title-content",children:[(0,o.jsx)("h2",{children:n}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:(0,o.jsx)(u(),{href:r,children:(0,o.jsx)("a",{children:t})})}),(0,o.jsx)("li",{children:c})]})]})}),(0,o.jsxs)("div",{className:"lines",children:[(0,o.jsx)("div",{className:"line"}),(0,o.jsx)("div",{className:"line"}),(0,o.jsx)("div",{className:"line"})]})]})}}]),r}(i.Component);n.Z=d},78348:function(e,n,r){"use strict";var t=r(51438),c=r(52951),s=r(88029),a=r(5950),o=r(85893),i=r(67294),l=r(41664),u=r.n(l),d=function(e){(0,s.Z)(r,e);var n=(0,a.Z)(r);function r(){return(0,t.Z)(this,r),n.apply(this,arguments)}return(0,c.Z)(r,[{key:"render",value:function(){(new Date).getFullYear();return(0,o.jsxs)("footer",{className:"footer-area",children:[(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsx)("div",{className:"col-md-12",children:(0,o.jsx)("div",{className:"single-footer-widget",children:(0,o.jsxs)("div",{className:"footer-contact-list",children:[(0,o.jsx)("div",{className:"title",children:"Contacts"}),(0,o.jsxs)("div",{className:"info",children:[(0,o.jsx)("strong",{children:"Email:"})," jangjun_park@portal301.com"]}),(0,o.jsxs)("div",{className:"info",children:[(0,o.jsx)("strong",{children:"Phone:"})," +82 10-5609-9527"]})]})})})})}),(0,o.jsx)("div",{className:"copyright-area",children:(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row align-items-center",children:(0,o.jsx)("div",{className:"col-md-12",children:(0,o.jsx)("ul",{children:(0,o.jsx)("li",{children:(0,o.jsx)(u(),{href:"/",children:(0,o.jsx)("a",{children:"\xa9 Copyright PORTAL301 All Rights Reserved."})})})})})})})})]})}}]),r}(i.Component);n.Z=d},44108:function(e,n,r){"use strict";r.d(n,{Z:function(){return d}});var t=r(828),c=r(82222),s=r(85893),a=r(67294),o=r(13823),i=r(70461),l=r(9473),u=r(32505);function d(){var e=(0,l.I0)(),n=(0,l.v9)(u.h5),r=(0,a.useRef)(),d=(0,l.v9)(u.L4),h=(0,a.useState)(!0),m=h[0],g=h[1],v=(0,t.Z)((0,i.Z)(["id","nickname"]),2),p=v[0];v[1];(0,a.useEffect)((function(){return console.log("cookies.id:",p.id),"undefined"===p.id&&console.log("aaaaaaaaa",(0,c.Z)(p.id)),void 0===p.id||"undefined"===p.id?(r.current=!1,e((0,u.Q2)(!1)),e((0,u.vm)("")),e((0,u.ng)(""))):(r.current=!0,e((0,u.Q2)(!0)),e((0,u.vm)(p.id)),e((0,u.ng)(p.nickname))),console.log("is?",r.current),document.getElementById("navbar").classList.add("is-sticky"),function(){!1}}),[]);var f=m?"collapse navbar-collapse":"collapse navbar-collapse show",x=m?"navbar-toggler navbar-toggler-right collapsed":"navbar-toggler navbar-toggler-right";return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{id:"navbar",className:"navbar-area",children:(0,s.jsx)("div",{className:"main-nav",children:(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)("div",{className:"navbar navbar-expand-md navbar-light",children:[(0,s.jsx)(o.Z,{href:"/",children:(0,s.jsxs)("a",{className:"navbar-brand",children:[(0,s.jsx)("img",{src:"/images/main_bar.png",className:"main-bar",alt:"logo"}),(0,s.jsx)("img",{src:"/images/main_logo3.png",className:"optional-logo",alt:"logo"})]})}),(0,s.jsxs)("button",{onClick:function(){g((function(e){return!e}))},className:x,type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:[(0,s.jsx)("span",{className:"icon-bar top-bar"}),(0,s.jsx)("span",{className:"icon-bar middle-bar"}),(0,s.jsx)("span",{className:"icon-bar bottom-bar"})]}),(0,s.jsxs)("div",{className:f,id:"navbarSupportedContent",children:[(0,s.jsxs)("ul",{className:"navbar-nav",children:[!1===n?(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(o.Z,{href:"/registration",activeClassName:"active",children:(0,s.jsx)("a",{className:"nav-link",children:"Registration"})})}):(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(o.Z,{href:"/mypage",activeClassName:"active",children:(0,s.jsxs)("a",{className:"nav-link",children:[d,"\ub2d8"]})})}),!1===n?(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(o.Z,{href:"/login",activeClassName:"active",children:(0,s.jsx)("a",{className:"nav-link",children:"Log In"})})}):(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(o.Z,{href:"/logout",activeClassName:"active",children:(0,s.jsx)("a",{className:"nav-link",children:"Log Out"})})})]}),(0,s.jsx)("div",{className:"others-options"})]})]})})})})})}},12251:function(e,n,r){"use strict";r.r(n);var t=r(47568),c=r(70655),s=r(85893),a=r(67294),o=r(50960),i=r(86809),l=r.n(i),u=r(96894),d=(r(18584),r(44108)),h=r(73538),m=r(78348);n.default=function(e){var n,r=function(e){e.pause(),e.srcObject=null},i=function(e){var n=e.getTracks();n?n.forEach((function(e){return e.stop()})):console.warn("NO tracks")},g=function(){R.current&&(R.current.close(),R.current=null,x.current=null,console.log("socket.io closed.."))},v=function(e,n){return new Promise((function(r,t){R.current.emit(e,n,(function(e,n){e?t(e):r(n)}))}))},p=(0,a.useRef)(),f=(0,a.useRef)(),x=(0,a.useRef)(),j=(0,a.useRef)(),b=(0,a.useRef)(),N=(0,a.useRef)(),k=(0,a.useRef)(),R=(0,a.useRef)(),w=(0,a.useState)(!0),Z=w[0],C=w[1],y=(0,a.useState)(!0),_=y[0],P=y[1],T=(0,a.useState)(!1),E=T[0],S=T[1],O=(0,a.useState)(!1),A=O[0],I=O[1];function D(){return D=(0,t.Z)((function(){var e,n,r,s,a,o,i,l,u,d;return(0,c.__generator)(this,(function(h){switch(h.label){case 0:return f.current?R.current?[3,2]:[4,M().catch((function(e){console.error(e)}))]:(console.warn("WARN: local media NOT READY"),[2]);case 1:h.sent(),h.label=2;case 2:return[4,v("createRoom",{streamer:x.current})];case 3:return e=h.sent(),console.log("response msg from server >>",e),[4,v("makeRouter",x.current)];case 4:return n=h.sent(),r=n.targetRouterrouter,s=n.allRouters,console.log("targetRouterrouter?",r),console.log("allRouters?",s),[4,v("getRouterRtpCapabilities",x.current)];case 5:return a=h.sent(),console.log("getRouterRtpCapabilities:",a),[4,L(a)];case 6:return h.sent(),console.log("--- createProducerTransport --"),[4,v("createProducerTransport",x.current)];case 7:return o=h.sent(),console.log("transport params:",o),b.current=j.current.createSendTransport(o),console.log("createSendTransport:",b),b.current.on("connect",function(){var e=(0,t.Z)((function(e,n,r){var t;return(0,c.__generator)(this,(function(c){return t=e.dtlsParameters,console.log("--trasnport connect"),v("connectProducerTransport",{dtlsParameters:t,socketid:x.current}).then(n).catch(r),[2]}))}));return function(n,r,t){return e.apply(this,arguments)}}()),b.current.on("produce",function(){var e=(0,t.Z)((function(e,n,r){var t,s,a,o;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:t=e.kind,s=e.rtpParameters,console.log("--trasnport produce"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,v("produce",{socketid:x.current,transportId:b.current.id,kind:t,rtpParameters:s})];case 2:return a=c.sent().id,n({id:a}),[3,4];case 3:return o=c.sent(),r(o),[3,4];case 4:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}()),b.current.on("connectionstatechange",(function(e){switch(e){case"connecting":console.log("publishing...");break;case"connected":console.log("published"),I(!0);break;case"failed":console.log("failed"),b.current.close()}})),Z?(i=f.current.getVideoTracks()[0])?(l={track:i},[4,b.current.produce(l)]):[3,9]:[3,9];case 8:N.current=h.sent(),h.label=9;case 9:return _&&(u=f.current.getAudioTracks()[0])?(d={track:u},[4,b.current.produce(d)]):[3,11];case 10:k.current=h.sent(),h.label=11;case 11:return[2]}}))})),D.apply(this,arguments)}(0,a.useEffect)((function(){M()}),[]);var L=function(){var e=(0,t.Z)((function(e){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:try{j.current=new o.Device,console.log("device.current"),console.log(j.current)}catch(r){"UnsupportedError"===r.name&&console.error("browser not supported")}return console.log("device.current start"),console.log(j.current),console.log("device.current end"),[4,j.current.load({routerRtpCapabilities:e})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),M=function(){return R.current=l()(u.Ki,{transports:["websocket"]}),new Promise((function(e,r){(n=R.current).on("connect",(function(e){console.log("socket.io connected()")})),n.on("error",(function(e){console.error("socket.io ERROR:",e),r(e)})),n.on("message",(function(r){console.log("socket.io message:",r),"welcome"===r.type?(n.id!==r.id&&console.warn("WARN: something wrong with clientID",n.io,r.id),x.current=r.id,console.log("connected to server. clientId="+x.current),e()):console.error("UNKNOWN message from server:",r)})),n.on("newProducer",function(){var e=(0,t.Z)((function(e){return(0,c.__generator)(this,(function(n){return console.warn("IGNORE socket.io newProducer:",e),[2]}))}));return function(n){return e.apply(this,arguments)}}())}))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{}),(0,s.jsx)(h.Z,{pageTitle:"MediaSoup",homePageUrl:"/",homePageText:"MediaSoup",activePageText:"Publish",bgImgClass:"item-bg2"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{disabled:E,onChange:function(e){C(!Z)},type:"checkbox",checked:Z}),(0,s.jsx)("label",{children:"video"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{disabled:E,onChange:function(e){P(!_)},type:"checkbox",checked:_}),(0,s.jsx)("label",{children:"audio"})]}),(0,s.jsx)("button",{disabled:E,onClick:function(){f.current?console.warn("WARN: local media ALREADY started"):navigator.mediaDevices.getUserMedia({audio:_,video:Z}).then((function(e){f.current=e,function(e,n){if(!e.srcObject)return e.srcObject=n,e.volume=0,e.play();console.warn("element ALREADY playing, so ignore")}(p.current,f.current),S(!0)})).catch((function(e){console.error("media ERROR:",e)}))},children:"Start Media"}),(0,s.jsx)("button",{disabled:!E||A,onClick:function(){f.current&&(r(p.current),i(f.current),f.current=null,S(!1))},children:"Stop Media"}),(0,s.jsx)("button",{disabled:A||!E,onClick:function(){return D.apply(this,arguments)},children:"publish"}),(0,s.jsx)("button",{disabled:!A||!E,onClick:function(){f.current&&(r(p.current),i(f.current),f.current=null),N.current&&(N.current.close(),N.current=null),k.current&&(k.current.close(),k.current=null),b.current&&(b.current.close(),b.current=null),g(),I(!1),S(!1)},children:"Disconnect"}),(0,s.jsxs)("div",{children:["local video",(0,s.jsx)("video",{ref:p,autoPlay:!0,style:{width:"240px",height:"180px",border:"1px solid black"}})]})]}),(0,s.jsx)(m.Z,{})]})}},96894:function(e,n,r){"use strict";r.d(n,{Ki:function(){return c},d5:function(){return t}});var t="https://api.portal301.com/",c="https://13.209.14.100:3333"},13823:function(e,n,r){"use strict";var t=r(26042),c=r(69396),s=r(99534),a=r(85893),o=r(11163),i=r(41664),l=r.n(i),u=r(67294);n.Z=(0,o.withRouter)((function(e){var n=e.router,r=e.children,o=(0,s.Z)(e,["router","children"]),i=u.Children.only(r),d=i.props.className||"";return n.pathname===o.href&&o.activeClassName&&(d="".concat(d," ").concat(o.activeClassName).trim()),delete o.activeClassName,(0,a.jsx)(l(),(0,c.Z)((0,t.Z)({},o),{children:u.cloneElement(i,{className:d})}))}))},77020:function(){}},function(e){e.O(0,[1664,5234,5077,9774,2888,179],(function(){return n=74807,e(e.s=n);var n}));var n=e.O();_N_E=n}]);