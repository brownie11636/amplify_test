(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1469],{91958:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mediasoup/subscribe",function(){return r(68865)}])},73538:function(e,n,r){"use strict";var t=r(51438),s=r(52951),c=r(88029),a=r(5950),o=r(85893),i=r(67294),l=r(41664),u=r.n(l),d=function(e){(0,c.Z)(r,e);var n=(0,a.Z)(r);function r(){return(0,t.Z)(this,r),n.apply(this,arguments)}return(0,s.Z)(r,[{key:"render",value:function(){var e=this.props,n=e.pageTitle,r=e.homePageUrl,t=e.homePageText,s=e.activePageText,c=e.bgImgClass;return(0,o.jsxs)("div",{className:"page-title-area ".concat(c),children:[(0,o.jsx)("div",{className:"container",children:(0,o.jsxs)("div",{className:"page-title-content",children:[(0,o.jsx)("h2",{children:n}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:(0,o.jsx)(u(),{href:r,children:(0,o.jsx)("a",{children:t})})}),(0,o.jsx)("li",{children:s})]})]})}),(0,o.jsxs)("div",{className:"lines",children:[(0,o.jsx)("div",{className:"line"}),(0,o.jsx)("div",{className:"line"}),(0,o.jsx)("div",{className:"line"})]})]})}}]),r}(i.Component);n.Z=d},78348:function(e,n,r){"use strict";var t=r(51438),s=r(52951),c=r(88029),a=r(5950),o=r(85893),i=r(67294),l=r(41664),u=r.n(l),d=function(e){(0,c.Z)(r,e);var n=(0,a.Z)(r);function r(){return(0,t.Z)(this,r),n.apply(this,arguments)}return(0,s.Z)(r,[{key:"render",value:function(){(new Date).getFullYear();return(0,o.jsxs)("footer",{className:"footer-area",children:[(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsx)("div",{className:"col-md-12",children:(0,o.jsx)("div",{className:"single-footer-widget",children:(0,o.jsxs)("div",{className:"footer-contact-list",children:[(0,o.jsx)("div",{className:"title",children:"Contacts"}),(0,o.jsxs)("div",{className:"info",children:[(0,o.jsx)("strong",{children:"Email:"})," jangjun_park@portal301.com"]}),(0,o.jsxs)("div",{className:"info",children:[(0,o.jsx)("strong",{children:"Phone:"})," +82 10-5609-9527"]})]})})})})}),(0,o.jsx)("div",{className:"copyright-area",children:(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row align-items-center",children:(0,o.jsx)("div",{className:"col-md-12",children:(0,o.jsx)("ul",{children:(0,o.jsx)("li",{children:(0,o.jsx)(u(),{href:"/",children:(0,o.jsx)("a",{children:"\xa9 Copyright PORTAL301 All Rights Reserved."})})})})})})})})]})}}]),r}(i.Component);n.Z=d},44108:function(e,n,r){"use strict";r.d(n,{Z:function(){return d}});var t=r(828),s=r(82222),c=r(85893),a=r(67294),o=r(13823),i=r(70461),l=r(9473),u=r(32505);function d(){var e=(0,l.I0)(),n=(0,l.v9)(u.h5),r=(0,a.useRef)(),d=(0,l.v9)(u.L4),h=(0,a.useState)(!0),m=h[0],v=h[1],f=(0,t.Z)((0,i.Z)(["id","nickname"]),2),p=f[0];f[1];(0,a.useEffect)((function(){return console.log("cookies.id:",p.id),"undefined"===p.id&&console.log("aaaaaaaaa",(0,s.Z)(p.id)),void 0===p.id||"undefined"===p.id?(r.current=!1,e((0,u.Q2)(!1)),e((0,u.vm)("")),e((0,u.ng)(""))):(r.current=!0,e((0,u.Q2)(!0)),e((0,u.vm)(p.id)),e((0,u.ng)(p.nickname))),console.log("is?",r.current),document.getElementById("navbar").classList.add("is-sticky"),function(){!1}}),[]);var g=m?"collapse navbar-collapse":"collapse navbar-collapse show",x=m?"navbar-toggler navbar-toggler-right collapsed":"navbar-toggler navbar-toggler-right";return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{id:"navbar",className:"navbar-area",children:(0,c.jsx)("div",{className:"main-nav",children:(0,c.jsx)("div",{className:"container",children:(0,c.jsxs)("div",{className:"navbar navbar-expand-md navbar-light",children:[(0,c.jsx)(o.Z,{href:"/",children:(0,c.jsxs)("a",{className:"navbar-brand",children:[(0,c.jsx)("img",{src:"/images/main_bar.png",className:"main-bar",alt:"logo"}),(0,c.jsx)("img",{src:"/images/main_logo3.png",className:"optional-logo",alt:"logo"})]})}),(0,c.jsxs)("button",{onClick:function(){v((function(e){return!e}))},className:x,type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:[(0,c.jsx)("span",{className:"icon-bar top-bar"}),(0,c.jsx)("span",{className:"icon-bar middle-bar"}),(0,c.jsx)("span",{className:"icon-bar bottom-bar"})]}),(0,c.jsxs)("div",{className:g,id:"navbarSupportedContent",children:[(0,c.jsxs)("ul",{className:"navbar-nav",children:[!1===n?(0,c.jsx)("li",{className:"nav-item",children:(0,c.jsx)(o.Z,{href:"/registration",activeClassName:"active",children:(0,c.jsx)("a",{className:"nav-link",children:"Registration"})})}):(0,c.jsx)("li",{className:"nav-item",children:(0,c.jsx)(o.Z,{href:"/mypage",activeClassName:"active",children:(0,c.jsxs)("a",{className:"nav-link",children:[d,"\ub2d8"]})})}),!1===n?(0,c.jsx)("li",{className:"nav-item",children:(0,c.jsx)(o.Z,{href:"/login",activeClassName:"active",children:(0,c.jsx)("a",{className:"nav-link",children:"Log In"})})}):(0,c.jsx)("li",{className:"nav-item",children:(0,c.jsx)(o.Z,{href:"/logout",activeClassName:"active",children:(0,c.jsx)("a",{className:"nav-link",children:"Log Out"})})})]}),(0,c.jsx)("div",{className:"others-options"})]})]})})})})})}},68865:function(e,n,r){"use strict";r.r(n);var t=r(47568),s=r(828),c=r(70655),a=r(85893),o=r(67294),i=r(50960),l=r(86809),u=r.n(l),d=r(96894),h=r(44108),m=r(73538),v=r(78348);n.default=function(e){var n=function(e){console.log("list Update..."),C.current=e;var n=_,r=!0,t=!1,c=void 0;try{for(var a,o=Object.entries(Object(C.current))[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var i=(0,s.Z)(a.value,2),l=i[0],u=i[1];n=n.concat("".concat(l,":").concat(u.socketid))}}catch(d){t=!0,c=d}finally{try{r||null==o.return||o.return()}finally{if(t)throw c}}O((function(e){return n}))},r=function(e,n){var r=p.current;if(r.srcObject)r.srcObject.addTrack(n);else{var t=new MediaStream;t.addTrack(n),function(e,n){if(!e.srcObject)return e.srcObject=n,e.volume=0,p.current=e,console.log("playVideo"),console.log(p),e.play();console.warn("element ALREADY playing, so ignore")}(r,t).then((function(){r.volume=1})).catch((function(e){console.error("media ERROR:",e)}))}},l=function(e,n){return new Promise((function(r,t){k.current.emit(e,n,(function(e,n){e?t(e):r(n)}))}))},f=function(){p.current&&(p.current.pause(),p.current.srcObject=null)},p=(0,o.useRef)(),g=((0,o.useRef)(),(0,o.useRef)()),x=(0,o.useRef)(),j=(0,o.useRef)(),b=(0,o.useRef)(),N=(0,o.useRef)(),k=(0,o.useRef)(),y=(0,o.useState)(""),R=y[0],w=y[1],C=(0,o.useRef)(),Z=(0,o.useState)([]),_=Z[0],O=Z[1],P=(0,o.useState)(!1),T=P[0],E=P[1],S=(0,o.useState)(!1);function I(){return I=(0,t.Z)((function(){var e,n,r;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:return k.current?[3,2]:[4,M().catch((function(e){console.error(e)}))];case 1:s.sent(),s.label=2;case 2:return[4,l("getRouterRtpCapabilities",e=R)];case 3:return n=s.sent(),console.log("getRouterRtpCapabilities:",n),[4,D(n)];case 4:return s.sent(),console.log("--- createConsumerTransport --"),[4,l("createConsumerTransport",{socketid:e})];case 5:return r=s.sent(),console.log("transport params:",r),j.current=x.current.createRecvTransport(r),console.log("createConsumerTransport:",j),j.current.on("connect",function(){var e=(0,t.Z)((function(e,n,r){var t;return(0,c.__generator)(this,(function(s){return t=e.dtlsParameters,console.log("--consumer trasnport connect"),l("connectConsumerTransport",{dtlsParameters:t}).then(n).catch(r),[2]}))}));return function(n,r,t){return e.apply(this,arguments)}}()),j.current.on("connectionstatechange",(function(e){switch(e){case"connecting":console.log("subscribing...");break;case"connected":console.log("subscribed"),E(!0);break;case"failed":console.log("failed"),j.current.close()}})),[4,L(j.current,"video")];case 6:return b.current=s.sent(),[4,L(j.current,"audio")];case 7:return N.current=s.sent(),[2]}}))})),I.apply(this,arguments)}function L(e,n){return A.apply(this,arguments)}function A(){return(A=(0,t.Z)((function(e,n){var r;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,K(e,n)];case 1:return(r=t.sent())?(console.log("-- track exist, consumer ready. kind="+n),"video"===n?(console.log("-- resume kind="+n),l("resume",{kind:n}).then((function(){return console.log("resume OK"),r})).catch((function(e){return console.error("resume ERROR:",e),r}))):console.log("-- do not resume kind="+n),[2]):(console.log("-- no consumer yet. kind="+n),[2,null])}}))}))).apply(this,arguments)}function D(e){return U.apply(this,arguments)}function U(){return(U=(0,t.Z)((function(e){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:try{x.current=new i.Device}catch(r){"UnsupportedError"===r.name&&console.error("browser not supported")}return[4,x.current.load({routerRtpCapabilities:e})];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}function K(e,n){return F.apply(this,arguments)}function F(){return(F=(0,t.Z)((function(e,n){var t,s,a,o,i,u,d,h,m;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return console.log("--start of consume --kind="+n),t=R,s=x.current.rtpCapabilities,[4,l("consume",{rtpCapabilities:s,kind:n,socketid:t}).catch((function(e){console.error("consume ERROR:",e)}))];case 1:return a=c.sent(),o=a.producerId,i=a.id,u=a.kind,d=a.rtpParameters,o?(h={},[4,e.consume({id:i,producerId:o,kind:u,rtpParameters:d,codecOptions:h})]):[3,3];case 2:return m=c.sent(),r(g.current,m.track),console.log("--end of consume"),[2,m];case 3:return console.warn("--- remote producer NOT READY"),[2,null];case 4:return[2]}}))}))).apply(this,arguments)}S[0],S[1],(0,o.useEffect)((function(){function e(){return(e=(0,t.Z)((function(){var e;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,l("serviceList",{})];case 1:return e=r.sent().allRouters,console.log("allrouters?",e),n(e),[2]}}))}))).apply(this,arguments)}M(),function(){e.apply(this,arguments)}()}),[]);var M=function(){return k.current=u()(d.Ki,{transports:["websocket"]}),new Promise((function(e,r){var s=k.current;s.on("listUpdate",(function(e){n(e)})),s.on("connect",(function(e){console.log("socket.io connected()")})),s.on("error",(function(e){console.error("socket.io ERROR:",e),r(e)})),s.on("message",(function(n){console.log("socket.io message:",n),"welcome"===n.type?(s.id!==n.id&&console.warn("WARN: something wrong with clientID",s.io,n.id),g.current=n.id,console.log("connected to server. clientId="+g.current),e()):console.error("UNKNOWN message from server:",n)})),s.on("newProducer",function(){var e=(0,t.Z)((function(e){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return console.log("socket.io newProducer:",e),j.current?"video"!==e.kind?[3,2]:[4,L(j.current,e.kind)]:[3,4];case 1:return b.current=n.sent(),[3,4];case 2:return"audio"!==e.kind?[3,4]:[4,L(j.current,e.kind)];case 3:N.current=n.sent(),n.label=4;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}()),s.on("producerClosed",(function(e){console.log("socket.io producerClosed:",e);var n,r=e.localId,t=e.remoteId,s=e.kind;console.log("--try removeConsumer remoteId="+t+", localId="+r+", kind="+s),"video"===s?b.current&&(b.current.close(),b.current=null):"audio"===s&&N.current&&(N.current.close(),N.current=null),t?(n=t,console.log(" ---- removeRemoteVideo() id="+n)):f()}))}))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{}),(0,a.jsx)(m.Z,{pageTitle:"MediaSoup",homePageUrl:"/",homePageText:"MediaSoup",activePageText:"Subscribe",bgImgClass:"item-bg2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{disabled:T,onClick:function(){return I.apply(this,arguments)},children:"Subscribe"}),(0,a.jsx)("button",{disabled:!T,onClick:function(){b.current&&(b.current.close(),b.current=null),N.current&&(N.current.close(),N.current=null),j.current&&(j.current.close(),j.current=null),f(),E(!1)},children:"Disconnect"}),(0,a.jsxs)("div",{children:["remote video",(0,a.jsx)("br",{}),(0,a.jsx)("div",{children:(0,a.jsx)("video",{ref:p,autoPlay:!0,style:{width:"240px",height:"180px",border:"1px solid black"}})}),(0,a.jsxs)("select",{onChange:function(e){console.log("handleSelected? >>",e.target.value),w(e.target.value)},value:R,children:[(0,a.jsx)("option",{value:"null",children:"=== \uc2a4\ud2b8\ub9ac\uba38 \uc120\ud0dd ==="}),_.map((function(e){return(0,a.jsx)("option",{value:e.split(":")[1],children:e},e)}))]})]})]}),(0,a.jsx)(v.Z,{})]})}},96894:function(e,n,r){"use strict";r.d(n,{Ki:function(){return s},d5:function(){return t}});var t="https://api.portal301.com/",s="https://13.209.14.100:3333"},13823:function(e,n,r){"use strict";var t=r(26042),s=r(69396),c=r(99534),a=r(85893),o=r(11163),i=r(41664),l=r.n(i),u=r(67294);n.Z=(0,o.withRouter)((function(e){var n=e.router,r=e.children,o=(0,c.Z)(e,["router","children"]),i=u.Children.only(r),d=i.props.className||"";return n.pathname===o.href&&o.activeClassName&&(d="".concat(d," ").concat(o.activeClassName).trim()),delete o.activeClassName,(0,a.jsx)(l(),(0,s.Z)((0,t.Z)({},o),{children:u.cloneElement(i,{className:d})}))}))},77020:function(){}},function(e){e.O(0,[1664,5234,5077,9774,2888,179],(function(){return n=91958,e(e.s=n);var n}));var n=e.O();_N_E=n}]);